type Role {
  id: ID!
  name: String!
}

type Skill {
  id: ID!
  name: String!
  level: Int! # 0-4
}

type Collaborator {
  id: ID!
  name: String!
  avatar: String
  roles: [Role!]!
  skills: [Skill!]!
  contractedHours: Int! # e.g., 40 for full week
  allocations: [Allocation!]!
}

type Project {
  id: ID!
  name: String!
  requiredSkills: [Skill!]!
  sprints: [Sprint!]!
  contractedHours: Int! # Total hours sold/contracted
  allocations: [Allocation!]!
}

type Sprint {
  id: ID!
  name: String!
  startDate: String!
  endDate: String!
}

type Allocation {
  id: ID!
  collaborator: Collaborator!
  project: Project!
  roles: [Role!]!
  dedicationPercentage: Int! # 0-100
  hours: Int! # Calculated from percentage
  startWeek: String! # ISO 'YYYY-Www' (e.g. '2025-W01')
  endWeek: String # Inclusive. Null means indefinite.
}

type Milestone {
  id: ID!
  project: Project!
  name: String!
  date: String! # ISO Date 'YYYY-MM-DD'
  type: String # e.g. 'Delivery', 'Meeting', 'Version'
}

type Project {
  id: ID!
  name: String!
  contractedHours: Int!
  allocations: [Allocation!]
  requiredRoles: [ProjectRequirement!]
  sprints: [Sprint!]
  milestones: [Milestone!] # New
}

type Query {
  roles: [Role!]!
  projects: [Project!]!
  collaborators: [Collaborator!]!
  project(id: ID!): Project
}

type Mutation {
  createRole(name: String!): Role!
  deleteRole(id: ID!): ID
  createProject(name: String!, contractedHours: Int!): Project!
  
  # Allocation Management
  createAllocation(projectId: ID!, collaboratorId: ID!, roleId: ID!, percentage: Int!, startWeek: String!): Allocation!
  updateAllocation(allocationId: ID!, percentage: Int!, endWeek: String): Allocation! 
  deleteAllocation(allocationId: ID!): ID
  addAllocationRole(allocationId: ID!, roleId: ID!): Role!
  removeAllocationRole(allocationId: ID!, roleId: ID!): ID
  
  # Milestones
  createMilestone(projectId: ID!, name: String!, date: String!, type: String): Milestone!
  deleteMilestone(id: ID!): ID
  
  # Requirements Management
  addProjectRequirement(projectId: ID!, roleId: ID!, resourceCount: Int, monthlyHours: Int): ProjectRequirement!
  removeProjectRequirement(projectId: ID!, requirementId: ID!): Boolean
  addRequirementSkill(projectId: ID!, requirementId: ID!, skillName: String!, level: Int!): Skill!
  removeRequirementSkill(projectId: ID!, requirementId: ID!, skillId: ID!): Boolean
  
  createCollaborator(name: String!, contractedHours: Int!): Collaborator!
  addCollaboratorSkill(collaboratorId: ID!, skillName: String!, level: Int!): Skill!
  removeCollaboratorSkill(collaboratorId: ID!, skillId: ID!): Boolean
  
  createTechnology(name: String!): Technology!
  deleteTechnology(id: ID!): ID
}
