enum RequirementStatus {
  DRAFT
  PENDING_REVIEW
  VALIDATED
  DEPRECATED
  BLOCKED
}

model FunctionalRequirement {
  id                 String  @id @default(uuid())
  number             Int     @default(0)
  title              String
  description        String
  generalDescription String?
  actors             String?
  preconditions      String?
  expectedInputs     String?
  detailedFlow       String?
  validations        String?
  expectedOutputs    String?
  systemMessages     String?
  mockupUrl          String?
  notes              String?

  status       RequirementStatus @default(DRAFT)
  // Versionado sem√°ntico
  versionMajor Int               @default(1)
  versionMinor Int               @default(0)
  versionPatch Int               @default(0)

  // For evolutivos: reference to the original requirement
  originalRequirementId String?
  originalRequirement   FunctionalRequirement?  @relation("RequirementEvolution", fields: [originalRequirementId], references: [id], onDelete: SetNull)
  evolutions            FunctionalRequirement[] @relation("RequirementEvolution")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  analystId String?
  analyst   User?   @relation(fields: [analystId], references: [id])

  history      FunctionalRequirementHistory[]
  workPackages WorkPackage[]
  tasks        Task[]

  // Relations to other requirements
  relatedTo   FunctionalRequirementRelation[] @relation("relatedFrom")
  relatedFrom FunctionalRequirementRelation[] @relation("relatedTo")
}
